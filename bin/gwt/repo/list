#!/bin/bash

#repos folder
if [[ ! "$(pwd)" =~ "$rootpath" ]]; then
  echo "not in repos folder"
  exit
fi

repo_owner=$(basename "$(pwd)")
repo_user="$(pwd | cut --delimiter=/ --fields=5)"

logged_owner="$(gh repo list ${repo_owner} --limit 1 --json owner --jq '.[0].owner.login')"
logged_user="$(gh repo list --limit 1 --json owner --jq '.[0].owner.login')"

if [[ ! "$repo_user" == "$logged_user" ]]; then
  echo "not logged as current repo user"
  echo "logged:$logged_user repo:$repo_user"
fi

#under organization
if [[ ! "$repo_owner" == "$repo_user" ]]; then

  if [[ ! "$logged_owner" == "$repo_owner"  ]]; then
    echo "not under organization"
    echo "gh auth refresh -s write:org"
    exit

  fi

fi

gh search repos $1 --owner "$repo_owner"

