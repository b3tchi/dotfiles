#!/bin/bash
#create root with master
mainbr="main"
devbr="develop"

# name="mpo-follow-up-db"
# acc="github.com-lego"

[[ -z $initcommit ]] && initcommit='repo creation commit'

if [[ -z "$path" ]]; then
  echo "using current folder no path specified"
  path=$PWD
fi

if [[ ! -d "$path" ]]; then
  echo "path is not exists"
  exit 0
fi

if [[ "$path"=="$rootpath" ]]; then
  echo "path cannot be in root please use on of the identity subfolders"
  exit 0
fi

if [[ -z $name ]]; then
  echo "name is empty"
  exit 0
fi

if [[ -d "$path/$name" ]]; then
  echo "folder already exists"
  exit 0
fi

#create main branch
mkdir -p "$path/$name/$mainbr"
cd "$path/$name/$mainbr"
git init .
git checkout -b $mainbr

touch README.md
git add README.md

git commit -m "$initcommit"

#clone from mainbr
brname=$devbr
brfull="$path/$name/$brname"

mkdir -p ${brfull}
git worktree add -b $brname ${brfull}

cd ${brfull}

# git checkout -b $brname

# git remote add origin "git@${acc}:LEGO/${name}.git"
# git pull origin $mainbr
# git pull --set-upstream origin $mainbr
