#!/bin/bash
description="
delete item in azure keyvault
"
declare -A mandatory_args=(
  [name]="name of item inside keyvault"
)
declare -A optional_args=(
  [public]="delete from shared keyvault"
)


main(){


  if [[ -z $public ]]; then
    gargs=(
      --subscription $KEYVAULT_0_SUBSCRIPTION
      --vault-name $KEYVAULT_0_NAME
    )
  else
    gargs=(
      --subscription $KEYVAULT_1_SUBSCRIPTION
      --vault-name $KEYVAULT_1_NAME
    )
  fi

  echo "confirm delete of $name from ${gargs[--vault-name]} by type 'yes'"
  read value

  if [[ "$value" != "yes" ]]; then
    exit 0
  fi

  gargs+=(
    --name "$name" \
  )

  az keyvault secret delete "${gargs[@]}"
  az keyvault secret purge "${gargs[@]}"
}
