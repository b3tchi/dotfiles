#tmux conf
set-hook -g client-detached 'run-shell "~/.local/bin/tmux-cleanup"'

if-shell '[ -n "$TERMUX_VERSION" ]' {
  set-option -g default-shell /data/data/com.termux/files/usr/bin/nu
} {
  set-option -g default-shell /usr/sbin/nu
}

bind r source-file ~/.tmux.conf \; run-shell "~/.local/bin/tmux-message 'Config reloaded'"

# Pin/Unpin toggle for panes (uses @pinned pane option)
bind P if-shell '[ "$(tmux show-option -pqv @pinned)" = "1" ]' \
    'set-option -p @pinned 0; run-shell "~/.local/bin/tmux-message \"Pane unpinned\""' \
    'set-option -p @pinned 1; run-shell "~/.local/bin/tmux-message \"Pane pinned\""'

# Fuzzy window switcher with preview (excludes current window)
bind w display-popup -E -w 90% -h 90% "tmux list-windows -F '#{window_name}:#{window_id}:#{window_active}' | grep -v ':1\$' | cut -d: -f1,2 | fzf --preview='sh -c \"tmux capture-pane -ep -t {2}\"' --preview-window=top:70%:border-bottom --delimiter=':' | cut -d: -f2 | xargs -r tmux select-window -t"

set -g default-terminal "tmux-256color"
set -ga terminal-overrides ",xterm-256color:RGB"

# Enable RGB colour if running in xterm(1)
set-option -sa terminal-overrides ",xterm*:Tc"

set -g set-titles on
set -g set-titles-string "#S[#W]"

set -g history-limit 10000

set -g mouse on

setw -g mode-keys vi

# Message settings
set -g message-style bg=black
set -g display-time 800

# Status bar settings
set -g status on
set -g status-position bottom
set -g status-style bg=black
set -g status-left "#{?#{==:#{@pinned},1},#[fg=colour208],#[default]}#W#[default]@#{session_group}"
set -g status-left-length 40
set -g status-right "#I"
set -g window-status-format ""
set -g window-status-current-format ""
set -g status-justify left
